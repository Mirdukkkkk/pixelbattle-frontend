import{x as e,u as n,a as t,A as a,T as r,y as o,q as l,h as i,_ as c,d as s,b as u,c as d,k as p}from"./preact-DoPIZWeU.js";import{i as _,j as f,k as v,A as h,l as m,m as g,T as w,n as b,N as y,e as N,c as x,M as k,U as C,o as z,p as I,h as j,q as D,r as E,S as M,s as O}from"./main-CKuROTs4.js";import{P as T}from"./render-D473Hyb3.js";import{S}from"./snapshot-bDIYD3Nl.js";const A={wrapper:"_wrapper_2zwlj_1",cooldown:"_cooldown_2zwlj_18",coordinates:"_coordinates_2zwlj_23",palette:"_palette_2zwlj_32"},B={wrapper:"_wrapper_ybck9_1",progress:"_progress_ybck9_8",label:"_label_ybck9_18"};function H(){const t=e(_);return t.hasCooldown.value?n("div",{className:B.wrapper,children:[n("progress",{className:B.progress,value:t.progress,max:"100"}),n("p",{className:B.label,children:[t.progress.value.toFixed(0),"%"]})]}):null}const q={group:"_group_1aovs_1"};function L({children:e}){return n("div",{className:q.group,children:e})}const $={color:"_color_gk3h4_1",appear:"_appear_gk3h4_1"};function F({color:t}){const a=e(f);return n("input",{type:"radio",name:"palette",value:t.toHex(),className:$.color,style:{backgroundColor:t.toHex()},checked:t.equals(a.palette.value.selected),onChange:()=>a.setCurrentColor(t)})}const K={wrapper:"_wrapper_n8bdy_1",buttons:"_buttons_n8bdy_9",button:"_button_n8bdy_9"};function V(){return(V=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}function P(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n.indexOf(t=o[a])>=0||(r[t]=e[t]);return r}function R(e){var n=a(e),t=a((function(e){n.current&&n.current(e)}));return n.current=e,t.current}var U=function(e,n,t){return void 0===n&&(n=0),void 0===t&&(t=1),e>t?t:e<n?n:e},X=function(e){return"touches"in e},Y=function(e){return e&&e.ownerDocument.defaultView||self},G=function(e,n,t){var a=e.getBoundingClientRect(),r=X(n)?function(e,n){for(var t=0;t<e.length;t++)if(e[t].identifier===n)return e[t];return e[0]}(n.touches,t):n;return{left:U((r.pageX-(a.left+Y(e).pageXOffset))/a.width),top:U((r.pageY-(a.top+Y(e).pageYOffset))/a.height)}},J=function(e){!X(e)&&e.preventDefault()},Q=t.memo((function(e){var n=e.onMove,l=e.onKey,i=P(e,["onMove","onKey"]),c=a(null),s=R(n),u=R(l),d=a(null),p=a(!1),_=r((function(){var e=function(e){J(e),(X(e)?e.touches.length>0:e.buttons>0)&&c.current?s(G(c.current,e,d.current)):t(!1)},n=function(){return t(!1)};function t(t){var a=p.current,r=Y(c.current),o=t?r.addEventListener:r.removeEventListener;o(a?"touchmove":"mousemove",e),o(a?"touchend":"mouseup",n)}return[function(e){var n,a=e.nativeEvent,r=c.current;if(r&&(J(a),n=a,(!p.current||X(n))&&r)){if(X(a)){p.current=!0;var o=a.changedTouches||[];o.length&&(d.current=o[0].identifier)}r.focus(),s(G(r,a,d.current)),t(!0)}},function(e){var n=e.which||e.keyCode;n<37||n>40||(e.preventDefault(),u({left:39===n?.05:37===n?-.05:0,top:40===n?.05:38===n?-.05:0}))},t]}),[u,s]),f=_[0],v=_[1],h=_[2];return o((function(){return h}),[h]),t.createElement("div",V({},i,{onTouchStart:f,onMouseDown:f,className:"react-colorful__interactive",ref:c,onKeyDown:v,tabIndex:0,role:"slider"}))})),W=function(e){return e.filter(Boolean).join(" ")},Z=function(e){var n=e.color,a=e.left,r=e.top,o=void 0===r?.5:r,l=W(["react-colorful__pointer",e.className]);return t.createElement("div",{className:l,style:{top:100*o+"%",left:100*a+"%"}},t.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:n}}))},ee=function(e,n,t){return void 0===n&&(n=0),void 0===t&&(t=Math.pow(10,n)),Math.round(t*e)/t},ne=function(e){return"#"===e[0]&&(e=e.substring(1)),e.length<6?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?ee(parseInt(e[3]+e[3],16)/255,2):1}:{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4,6),16),a:8===e.length?ee(parseInt(e.substring(6,8),16)/255,2):1}},te=function(e){var n=function(e){var n=e.s,t=e.v,a=e.a,r=(200-n)*t/100;return{h:ee(e.h),s:ee(r>0&&r<200?n*t/100/(r<=100?r:200-r)*100:0),l:ee(r/2),a:ee(a,2)}}(e);return"hsl("+n.h+", "+n.s+"%, "+n.l+"%)"},ae=function(e){var n=e.h,t=e.s,a=e.v,r=e.a;n=n/360*6,t/=100,a/=100;var o=Math.floor(n),l=a*(1-t),i=a*(1-(n-o)*t),c=a*(1-(1-n+o)*t),s=o%6;return{r:ee(255*[a,i,l,l,c,a][s]),g:ee(255*[c,a,a,i,l,l][s]),b:ee(255*[l,l,c,a,a,i][s]),a:ee(r,2)}},re=function(e){var n=e.toString(16);return n.length<2?"0"+n:n},oe=function(e){var n=e.r,t=e.g,a=e.b,r=e.a,o=r<1?re(ee(255*r)):"";return"#"+re(n)+re(t)+re(a)+o},le=function(e){var n=e.r,t=e.g,a=e.b,r=e.a,o=Math.max(n,t,a),l=o-Math.min(n,t,a),i=l?o===n?(t-a)/l:o===t?2+(a-n)/l:4+(n-t)/l:0;return{h:ee(60*(i<0?i+6:i)),s:ee(o?l/o*100:0),v:ee(o/255*100),a:r}},ie=t.memo((function(e){var n=e.hue,a=e.onChange,r=W(["react-colorful__hue",e.className]);return t.createElement("div",{className:r},t.createElement(Q,{onMove:function(e){a({h:360*e.left})},onKey:function(e){a({h:U(n+360*e.left,0,360)})},"aria-label":"Hue","aria-valuenow":ee(n),"aria-valuemax":"360","aria-valuemin":"0"},t.createElement(Z,{className:"react-colorful__hue-pointer",left:n/360,color:te({h:n,s:100,v:100,a:1})})))})),ce=t.memo((function(e){var n=e.hsva,a=e.onChange,r={backgroundColor:te({h:n.h,s:100,v:100,a:1})};return t.createElement("div",{className:"react-colorful__saturation",style:r},t.createElement(Q,{onMove:function(e){a({s:100*e.left,v:100-100*e.top})},onKey:function(e){a({s:U(n.s+100*e.left,0,100),v:U(n.v-100*e.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+ee(n.s)+"%, Brightness "+ee(n.v)+"%"},t.createElement(Z,{className:"react-colorful__saturation-pointer",top:1-n.v/100,left:n.s/100,color:te(n)})))})),se=function(e,n){if(e===n)return!0;for(var t in e)if(e[t]!==n[t])return!1;return!0};var ue="undefined"!=typeof window?c:o,de=new Map,pe=function(e){ue((function(){var n=e.current?e.current.ownerDocument:document;if(void 0!==n&&!de.has(n)){var t=n.createElement("style");t.innerHTML='.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>\')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}',de.set(n,t);var a="undefined"!=typeof __webpack_nonce__?__webpack_nonce__:void 0;a&&t.setAttribute("nonce",a),n.head.appendChild(t)}}),[])},_e=function(e){var n=e.className,r=e.colorModel,c=e.color,s=void 0===c?r.defaultColor:c,u=e.onChange,d=P(e,["className","colorModel","color","onChange"]),p=a(null);pe(p);var _=function(e,n,t){var r=R(t),c=i((function(){return e.toHsva(n)})),s=c[0],u=c[1],d=a({color:n,hsva:s});o((function(){if(!e.equal(n,d.current.color)){var t=e.toHsva(n);d.current={hsva:t,color:n},u(t)}}),[n,e]),o((function(){var n;se(s,d.current.hsva)||e.equal(n=e.fromHsva(s),d.current.color)||(d.current={hsva:s,color:n},r(n))}),[s,e,r]);var p=l((function(e){u((function(n){return Object.assign({},n,e)}))}),[]);return[s,p]}(r,s,u),f=_[0],v=_[1],h=W(["react-colorful",n]);return t.createElement("div",V({},d,{ref:p,className:h}),t.createElement(ce,{hsva:f,onChange:v}),t.createElement(ie,{hue:f.h,onChange:v,className:"react-colorful__last-control"}))},fe={defaultColor:"000",toHsva:function(e){return le(ne(e))},fromHsva:function(e){return function(e){return oe(ae(e))}({h:e.h,s:e.s,v:e.v,a:1})},equal:function(e,n){return e.toLowerCase()===n.toLowerCase()||se(ne(e),ne(n))}},ve=function(e){return t.createElement(_e,V({},e,{colorModel:fe}))},he=/^#?([0-9A-F]{3,8})$/i,me=function(e){var n=e.color,a=void 0===n?"":n,r=e.onChange,c=e.onBlur,s=e.escape,u=e.validate,d=e.format,p=e.process,_=P(e,["color","onChange","onBlur","escape","validate","format","process"]),f=i((function(){return s(a)})),v=f[0],h=f[1],m=R(r),g=R(c),w=l((function(e){var n=s(e.target.value);h(n),u(n)&&m(p?p(n):n)}),[s,p,u,m]),b=l((function(e){u(e.target.value)||h(s(a)),g(e)}),[a,s,u,g]);return o((function(){h(s(a))}),[a,s]),t.createElement("input",V({},_,{value:d?d(v):v,spellCheck:"false",onChange:w,onBlur:b}))},ge=function(e){return"#"+e},we=function(e){var n=e.prefixed,a=e.alpha,r=P(e,["prefixed","alpha"]),o=l((function(e){return e.replace(/([^0-9A-F]+)/gi,"").substring(0,a?8:6)}),[a]),i=l((function(e){return n=e,t=a,r=he.exec(n),3===(o=r?r[1].length:0)||6===o||!!t&&4===o||!!t&&8===o;var n,t,r,o}),[a]);return t.createElement(me,V({},r,{escape:o,format:n?ge:void 0,process:ge,validate:i}))};const be={button:"_button_1fd7s_1",primary:"_primary_1fd7s_20",danger:"_danger_1fd7s_24",disabled:"_disabled_1fd7s_28"};function ye(e){const t=[be.button,be[e.type??"primary"],e.disabled?be.disabled:null].join(" ");return"href"in e?n("a",{href:e.href,className:t,children:e.children}):n("button",{className:t,onClick:e.onClick,disabled:e.disabled,children:e.children})}function Ne(){const t=e(f),[a,r]=i(t.palette.value.selected.toHex()),[o,l]=i(!1);function c(){l(!o)}return n("div",{className:K.wrapper,children:[o?n("div",{className:"color-picker",children:[n(ve,{color:a,onChange:r}),n(we,{color:a,onChange:r,prefixed:!0}),n("div",{className:K.buttons,children:[n(ye,{onClick:function(){l(!o),t.addAndSelect(new h(a))},children:"Готово"}),n(ye,{onClick:c,type:"danger",children:"Отмена"})]})]}):null,n("button",{onClick:function(){r(t.palette.value.selected.toHex()),c()},className:K.button,children:n(v,{icon:"plus",className:K.icon,alt:"Выбрать цвет"})})]})}const xe={button:"_button_rn6tb_1",icon:"_icon_rn6tb_19"};function ke(){const t=e(f);return n("button",{className:xe.button,onClick:function(e){e.shiftKey?t.reset():t.removeColor(t.palette.value.selected)},disabled:t.isDefaultColor(t.palette.value.selected),children:n(v,{icon:"plus",className:xe.icon,alt:"Удалить выбранный цвет"})})}const Ce={wrapper:"_wrapper_1yg7w_1",input:"_input_1yg7w_5",icon:"_icon_1yg7w_25"};function ze(){const t=e(m);return n("div",{className:Ce.wrapper,children:[n("input",{type:"checkbox",name:"color-pick",className:Ce.input,onInput:()=>t.toggle(),checked:t.isEnabled.value}),n(v,{icon:"color-picker",className:Ce.icon,alt:"Пипетка",viewBoxSize:21})]})}const Ie={palette:"_palette_p4wtl_1","scale-down":"_scale-down_p4wtl_1",hr:"_hr_p4wtl_35"};function je(){const t=e(f);return t.load(),n("div",{className:Ie.palette,children:[n(L,{children:t.palette.value.colors.map((e=>n(F,{color:e})))}),n("hr",{className:Ie.hr}),n(L,{children:[n(ze,{}),n(Ne,{}),n(ke,{})]})]})}const De={coordinates:"_coordinates_wugpl_1",empty:"_empty_wugpl_7"};function Ee(){const t=e(g);return t.areCoordinatesSet.value?n("p",{className:De.coordinates,style:{animationDelay:"500ms",animationDuration:"500ms",opacity:t.areCoordinatesSet.value?1:0,transition:"opacity 500ms"},children:t.coordinates.value.x+", "+t.coordinates.value.y}):n("p",{className:[De.coordinates,De.empty].join(" "),children:"Пусто"})}const Me={wrapper:"_wrapper_3gazz_1",empty:"_empty_3gazz_9",tag:"_tag_3gazz_13"};function Oe(){const t=e(g);if(null===t.info.value)return n("div",{className:[Me.wrapper,Me.empty].join(" "),children:"Пусто"});if("loading"===t.info.value)return n("div",{className:Me.wrapper,style:{animationDelay:"500ms",animationDuration:"500ms",opacity:t.info.value?1:0,transition:"opacity 500ms"},children:"Загрузка..."});const a=t.info.value.author??"Без автора";return n("div",{className:Me.wrapper,children:n("p",{className:Me.info,children:[n("strong",{className:Me.author,children:a}),t.info.value.tag&&n("span",{className:Me.tag,children:t.info.value.tag})]})})}function Te(){return n("div",{className:A.wrapper,children:[n("div",{className:A.coordinates,children:[n(Ee,{}),n(Oe,{})]}),n("div",{className:A.cooldown,children:n(H,{})}),n("div",{className:A.palette,children:n(je,{})})]})}const Se={tags:"_tags_c0lwc_1",empty:"_empty_c0lwc_10"},Ae={tag:"_tag_giprq_1",place:"_place_giprq_12",name:"_name_giprq_46",score:"_score_giprq_53",selected:"_selected_giprq_57"};function Be({tag:t}){const a=e(w),r=[Ae.tag,t.name===a.selectedTag.value?Ae.selected:""].join(" "),o=e(b);return n("button",{className:r,onClick:function(){o.isAuthenticated.value&&(a.selectAndFetch(t.name),y.addNotification({type:"success",title:"Изменение тега",message:`Ваш новый тег: ${t.name}`}))},children:[n("p",{className:Ae.place,children:t.place+1}),n("p",{className:Ae.name,children:t.name}),n("p",{className:Ae.score,children:-1===t.pixels?"??":t.pixels})]})}const He={window:"_window_1291p_1",opened:"_opened_1291p_9",windowOpen:"_windowOpen_1291p_1",content:"_content_1291p_13",windowContentOpen:"_windowContentOpen_1291p_1",closed:"_closed_1291p_17",windowClose:"_windowClose_1291p_1",windowContentClose:"_windowContentClose_1291p_1",title:"_title_1291p_26",container:"_container_1291p_38"};function qe({children:e,title:t}){const[a,r]=i(!1),[l,c]=i(!1);return o((()=>{setTimeout((()=>{c(!0)}),1e3)}),[]),n("div",{className:`${He.window} ${a?He.opened:He.closed}`,children:[n("label",{htmlFor:He.window,className:He.title,onClick:()=>{r(!a)},children:t}),n("div",{className:He.content,children:l&&n("div",{className:He.container,children:e})})]})}const Le={input:"_input_1ptyx_1"};function $e({placeholder:e,onInput:t,min:a,max:r,type:o="text",defaultValue:l,value:i}){return n("input",{type:o,className:Le.input,value:i,placeholder:e,onInput:e=>t(e.currentTarget.value),defaultValue:l,minLength:a,maxLength:r,min:a,max:r})}const Fe=s(!1),Ke={form:"_form_1s9ls_1",closeIcon:"_closeIcon_1s9ls_7"};function Ve(){const t=e(w),[a,r]=i("");return n("div",{className:Ke.form,children:[n($e,{placeholder:"Новый тег",onInput:r,min:4,max:8}),n(ye,{onClick:function(){""!==a&&(t.selectAndFetch(a),y.addNotification({type:"success",title:"Изменение тега",message:`Ваш новый тег: ${a}`}),Fe.value=!1)},children:n(v,{icon:"plus"})}),n(ye,{onClick:function(){Fe.value=!1},type:"danger",children:n(v,{icon:"plus",className:Ke.closeIcon})})]})}const Pe={form:"_form_zsgc1_1"};function Re(){const t=e(w);return n("div",{className:Pe.form,children:[n(ye,{onClick:function(){Fe.value=!0},children:"Новый тег"}),n(ye,{onClick:function(){var e;(null==(e=N.user.value)?void 0:e.tag)&&(t.remove(),y.addNotification({type:"success",title:"Изменение тега",message:"Тег был сброшен"}))},type:"danger",children:"Убрать текущий"})]})}function Ue(){const[t,a]=i(),r=e(w),l=e(b);return o((()=>{r.fetch();const e=setInterval(r.fetch,x.time.update.tags);a(e)}),[]),n(qe,{title:"Теги",children:n("div",{className:Se.tags,children:[0===r.tags.value.length?n("p",{className:Se.empty,children:"Нет тегов"}):r.tags.value.map(((e,t)=>n(Be,{tag:e},e.name))),l.isAuthenticated.value?Fe.value?n(Ve,{}):n(Re,{}):null]})})}const Xe={sidebar:"_sidebar_1e4o4_1"},Ye={login:"_login_1e9cb_1",params:"_params_1e9cb_6",wrapper:"_wrapper_1e9cb_14"},Ge={wrapper:"_wrapper_zckff_1",label:"_label_zckff_7",value:"_value_zckff_11"};function Je({label:e,value:t}){return n("div",{className:Ge.wrapper,children:[n("p",{className:Ge.label,children:e}),n("p",{className:Ge.value,children:t})]})}const Qe={wrapper:"_wrapper_cw8zk_1",input:"_input_cw8zk_7"};function We({children:e,onChange:t,name:a}){return n("div",{class:Qe.wrapper,children:[n("input",{class:Qe.input,type:"checkbox",name:a,onChange:e=>t(Boolean(e.currentTarget.checked))}),n("label",{for:a,class:Qe.label,children:e})]})}const Ze={wrapper:"_wrapper_i2g06_1",checkboxes:"_checkboxes_i2g06_8"};function en(){const e=u({terms:!1,rules:!1}),t=d((()=>!Object.values(e.value).includes(!1)));return n("div",{class:Ze.wrapper,children:[n("div",{class:Ze.checkboxes,children:[n(We,{name:"terms",onChange:n=>{e.value={...e.value,terms:n}},children:["Я согласен с ",n("a",{href:x.media.help[0]+"/privacy",target:"_blank",children:"Политикой конфиденциальности"})," и ",n("a",{href:x.media.help[0]+"/terms",target:"_blank",children:"Условиями использования"})]}),n(We,{name:"rules",onChange:n=>{e.value={...e.value,rules:n}},children:["Я согласен с ",n("a",{href:x.media.help[0]+"/rules",target:"_blank",children:"Правилами PixelBattle"})]})]}),n(ye,{href:"/login",disabled:!t.value,children:"Войти"})]})}function nn(){var t,a,r,l,i,c;const s=e(b),u=e(w),d=e(k);o((()=>{s.load(),s.isAuthenticated.value&&s.fetch().then((()=>{var e;return u.select((null==(e=s.user.value)?void 0:e.tag)??"")}))}),[]);const p={"Имя":null==(t=s.user.value)?void 0:t.username,"Айди":null==(a=s.user.value)?void 0:a.userID,"Тег":null==(r=s.user.value)?void 0:r.tag,"Статус":(null==(l=s.user.value)?void 0:l.banned)?`Забанен по причине "${(null==(i=s.user.value)?void 0:i.banned.reason)??"Не указано"}"`:null,"Роль":{[C.User]:null,[C.Moderator]:"Модератор",[C.Admin]:"Админ"}[(null==(c=s.user.value)?void 0:c.role)??C.User]};return s.isAuthenticated.value?n(qe,{title:"Профиль",children:n("div",{class:Ye.wrapper,children:[n("div",{className:Ye.params,children:Object.entries(p).map((([e,t])=>t?n(Je,{value:t,label:e}):null))}),n(ye,{href:"/logout",children:"Выйти"})]})}):n("div",{class:Ye.login,children:n(ye,{onClick:()=>d.open("Вход",n(en,{})),children:"Войти"})})}const tn={notifications:"_notifications_64rx3_1"},an={notification:"_notification_10kz6_1","add-notification":"_add-notification_10kz6_1",title:"_title_10kz6_24",message:"_message_10kz6_29",success:"_success_10kz6_42",error:"_error_10kz6_46",animate:"_animate_10kz6_50","remove-notification":"_remove-notification_10kz6_1"};function rn({notification:e}){const[t,a]=i(""),[r,l]=i(setTimeout((()=>{}),0));return o((()=>{l(setTimeout((()=>{a(an.animate),setTimeout((()=>y.removeNotification(e.id)),200)}),x.time.notificationRemoved))}),[]),n("div",{className:[an.notification,an[e.type],t].join(" "),children:[n("p",{className:an.title,children:e.title}),n("p",{className:an.message,children:e.message})]})}function on(){const t=e(z);return n("div",{className:tn.notifications,children:t.notifications.value.map(((e,t)=>n(rn,{notification:e},e.id)))})}const ln={wrapper:"_wrapper_16c0i_1",wrapperActive:"_wrapperActive_16c0i_11",input:"_input_16c0i_15",or:"_or_16c0i_19",label:"_label_16c0i_23"};function cn(){const t=a(null),[r,o]=i(!1),l=e(I),c=e(j),s=e(z);async function u(e){const n=new D(new Blob([await e.arrayBuffer()]),E.RGBA);await n.process();c.image.value.size.x<n.size.x||c.image.value.size.y<n.size.y?s.addNotification({title:"Слишком большое изображение",message:"Размер изображения больше игрового поля",type:"error"}):l.setImage(n,e.name,new T(0,0))}function d(e){e.preventDefault(),o(!0)}function p(e){e.preventDefault(),o(!1)}return n("div",{class:[ln.wrapper,r?ln.wrapperActive:""].join(" "),onDrop:function(e){var n;e.preventDefault(),p(e);const t=null==(n=e.dataTransfer)?void 0:n.files;t&&t.length&&u(t[0])},onDragEnter:d,onDragOver:d,onDragLeave:p,children:[n("p",{class:ln.label,children:"Перетащите изображение"}),n("p",{class:ln.or,children:"или"}),n("input",{type:"file",accept:"image/*",onInput:function(e){e.preventDefault();const n=e.currentTarget.files;n&&n.length&&u(n[0])},ref:t,class:ln.input}),n(ye,{onClick:()=>{var e;return null==(e=t.current)?void 0:e.click()},children:"Выберите файл"})]})}const sn={coordinates:"_coordinates_1cczs_1",groups:"_groups_1cczs_7",group:"_group_1cczs_7",groupTitle:"_groupTitle_1cczs_20",wrapper:"_wrapper_1cczs_28",image:"_image_1cczs_34",imageName:"_imageName_1cczs_40",removeIcon:"_removeIcon_1cczs_49"};function un(){var t,a;const r=e(I),o=e(j);function l(e,n){const t=r.position.value.clone();t[e]=n,r.position.value=t,r.save()}return n("div",{class:sn.wrapper,children:[n("div",{class:sn.image,children:[n("p",{class:sn.imageName,children:r.imageName}),n(ye,{onClick:r.unsetImage,type:"danger",children:n(v,{icon:"plus",className:sn.removeIcon})})]}),n("div",{class:sn.groups,children:[n("div",{class:sn.group,children:[n("p",{class:sn.groupTitle,children:"Координаты"}),n("div",{class:sn.coordinates,children:[n($e,{min:0,max:null==(t=o.image.value)?void 0:t.size.x,type:"number",placeholder:"X координата",defaultValue:r.position.value.x.toString(),onInput:e=>l("x",parseInt(e))}),n($e,{min:0,max:null==(a=o.image.value)?void 0:a.size.y,type:"number",placeholder:"Y координата",defaultValue:r.position.value.y.toString(),onInput:e=>l("y",parseInt(e))})]})]}),n("div",{class:sn.group,children:[n("p",{class:sn.groupTitle,children:"Прозрачность"}),n($e,{min:0,max:100,type:"number",placeholder:"Прозрачность",defaultValue:r.opacity.value.toString(),onInput:function(e){r.opacity.value=parseInt(e),r.save()}})]})]})]})}function dn(){const t=e(I);return o((()=>{t.load()}),[]),n(qe,{title:"Изображение",children:t.isSet.value?n(un,{}):n(cn,{})})}const pn={wrapper:"_wrapper_faex0_1",wrapperActive:"_wrapperActive_faex0_11",input:"_input_faex0_15",or:"_or_faex0_19",label:"_label_faex0_23"};function _n(){return n(qe,{title:"Снимок холста",children:n("div",{className:pn.wrapper,children:[n(ye,{onClick:()=>{S.toggle()},children:S.enable.value?"Остановить":"Область"}),n("p",{class:pn.or,children:"или"}),n(ye,{onClick:()=>{S.fullScreenshot()},children:"Всего холста"}),S.empty.value?n(p,{}):n(p,{children:[n("p",{class:pn.groupTitle+pn.label,children:"Действия"}),n(ye,{onClick:()=>{S.toFile()},children:"Сохранить"})]}),n("p",{class:pn.label,children:"Множитель масштаба "}),n($e,{placeholder:"Множитель масштаба",onInput:e=>{!isNaN(e)&&(S.scale.value=Number(e))},type:"number",min:1,max:100,value:S.scale.value+""})]})})}function fn(){return n("div",{className:Xe.sidebar,children:[n(nn,{}),n(Ue,{}),n(dn,{}),n(_n,{}),n(on,{})]})}const vn={window:"_window_14goy_1",opened:"_opened_14goy_10",windowOpen:"_windowOpen_14goy_1",title:"_title_14goy_14",content:"_content_14goy_18",windowContentOpen:"_windowContentOpen_14goy_1",closed:"_closed_14goy_22",windowClose:"_windowClose_14goy_1",windowContentClose:"_windowContentClose_14goy_1",container:"_container_14goy_43",params:"_params_14goy_47",media:"_media_14goy_55",icons:"_icons_14goy_84"},hn={wrapper:"_wrapper_u7e1h_1",input:"_input_u7e1h_7"};function mn(){if(![11,0,1].includes((new Date).getMonth()))return null;const t=e(M);return n("div",{className:hn.wrapper,children:[n("input",{type:"checkbox",className:hn.input,onChange:function(e){t.settings.value={...t.settings.value,enableSnow:e.target.checked},t.save()},defaultChecked:t.settings.value.enableSnow}),n(v,{icon:"snowflake",alt:"Переключить снег",size:35,viewBoxSize:272})]})}function gn(){const t=e(O),a=e(j),[r,l]=i(),[c,s]=i(!1),[u,d]=i(!1);if(o((()=>{t.fetch(),l(setInterval(t.fetch,x.time.update.info)),setTimeout((()=>{d(!0)}),1e3)}),[]),null===t.info.value||null===a.image.value)return null;const p=t.info.value.ended,_="season:blank"===t.info.value.name?"Без названия":t.info.value.name,f=p?"🏁":"⚔️";return n("div",{className:`${vn.window} ${c?vn.opened:vn.closed}`,onClick:()=>{s(!c)},children:[n("label",{for:vn.window,className:vn.title,children:[_," ",f]}),n("div",{className:vn.content,children:u&&n("div",{className:vn.container,children:[n("div",{className:vn.params,children:[n(Je,{label:"Кулдаун",value:t.info.value.cooldown+"мс"}),n(Je,{label:"Размер",value:a.image.value.size.x+"x"+a.image.value.size.y}),n(Je,{label:"Онлайн",value:t.info.value.online.toString()})]}),n("div",{className:vn.icons,children:[n("div",{className:vn.media,children:Object.entries(x.media).map((([e,t])=>n("a",{href:t[0],target:"_blank",rel:"noopener noreferrer",children:n(v,{icon:e,alt:t[1],size:35,viewBoxSize:256})},e)))}),n(mn,{})]})]})})]})}const wn="_wrapper_101wi_1";function bn(){return n("div",{className:wn,children:[n(gn,{}),n(fn,{}),n(Te,{})]})}export{bn as TopBar};
